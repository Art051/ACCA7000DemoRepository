This is a new feature I implemented in feature1 branch.